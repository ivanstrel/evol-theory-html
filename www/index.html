<!DOCTYPE html>
<html>
  <head>
    <title>Теория эволюции</title>
    <meta name="author" content="Ivan I. Strelnikov">
    <meta name="description" content="The site with simple simulations of evolutionary processes">
    <meta charset="UTF-8">
    
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Material+Icons">
    <link rel="stylesheet" href="https://unpkg.com/bootstrap-material-design@4.1.1/dist/css/bootstrap-material-design.min.css" integrity="sha384-wXznGJNEXNG1NFsbm0ugrLFMQPWswR3lds2VeinahP8N0zJw9VWSopbjv2x7WCvX" crossorigin="anonymous">

    <!--Let browser know website is optimized for mobile-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    
    <!--Import jQuery before materialize.js-->
    <script type="text/javascript" src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
    <!-- Shiny scripts -->
    <script src="shared/shiny.js" type="text/javascript"></script>
    <!--Import shiny components-->
    <link rel="stylesheet" type="text/css" href="shared/shiny.css"/>

    <!-- Custom components -->
    <link rel="stylesheet" type="text/css" href="./css/index.css"/>
    <script src="./js/index.js" type="text/javascript"></script>
  </head>

  <body>
    <!-- Compiled and minified JavaScript -->
    <script src="https://unpkg.com/popper.js@1.12.6/dist/umd/popper.js" integrity="sha384-fA23ZRQ3G/J53mElWqVJEGJzU0sTs+SvzG8fXVWP+kJQ1lwFAOkcUOysnlKJC33U" crossorigin="anonymous"></script>
    <script src="https://unpkg.com/bootstrap-material-design@4.1.1/dist/js/bootstrap-material-design.js" integrity="sha384-CauSuKpEqAFajSpkdjv3z9t8E7RlpJ1UP0lKM/+NdtSarroVKu069AlsRPKkFBz9" crossorigin="anonymous"></script>
    
    <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    Nav bar 
    //~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
    <nav class="navbar navbar-expand-lg navbar-dark sticky-top">
      <a class="navbar-brand" data-toggle="tab" role="tab" href="#">Теория эволюции</a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNavDropdown" >
        <ul class="nav navbar-nav nav-tabs" role="tablist">

          <li class="nav-item">
            <a class="nav-link active" data-toggle="tab" role="tab" href="#panel1">Домой</a>
          </li>
  
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
              Практические
            </a>
            <div class="dropdown-menu" aria-labelledby="navbarDropdownMenuLink">
              <a class="dropdown-item" data-toggle="tab" role="tab" href="#panel2">Практическая 1</a>
              <a class="dropdown-item" data-toggle="tab" role="tab" href="#panel3">Практическая 2</a>
              <a class="dropdown-item" data-toggle="tab" role="tab" href="#panel2">Практическая 3</a>
            </div>
          </li>

          <li class="nav-item">
            <a class="nav-link" data-toggle="tab" role="tab" href="#panel2">Информация</a>
          </li>

        </ul>
      </div>
    </nav>

    <!-- ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    Tabs content
    //~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->
    <div class="tab-content text-dark">
      <!--Panel 1-->
      <div class="tab-pane fade in show active" id="panel1" role="tabpanel">
      <div class="container-fluid">
        <div class="row">
        <div class="col-md-8 offset-md-2 text-justify">
          <br>
          <center>
          <h3>Донецкий Национальный Университет</h3>
          <br>
          <h4>Практические работы к учебному курсу</h4>
          <br>
          <h1>Теория эволюции</h1>
          <br>
          <img src="./pics/Evolution_sucks_lowres.png" alt="Smiley face" height=auto width=50%>
          <br><br>
          <h3>Быстрый старт</h3>
          <p>Выберите тему занятия из выпадающего списка:</p>
          <p><em>навигационная панель</em> &rarr; <em>темы</em></p>
          <p>Приступайте к изучению материала</p>
          <h3>Краткие сведения</h3>
          <p>Все темы объеденены одинаковой структурой. Сначала дается сжатое представление рассматриваемого процесса или понятия – теоретическая чать. Далее студенту предлогается провести одну или более симуляций рассматриваемого процесса. Для этого потребуется ввести в соответствующие поля страницы начальные параметры модли. В большинстве случаев, для проведения симуляции, после ввода параметров нужно нажать кнопку <strong>смоделировать</strong>.</p>
          <p>Описание сути модели и ее параметров подается перед формой ввода данных. Разъяснение полученных данных приводиться после окна модели.</p>
          <p>К каждой пройденной теме студент готовит краткий отчет – домашнее задание. Отчет формируется на основе выполнения задач, которые сатвяться к каждой модели. Задачи расположены после основного окна вывода данных модели и представлены в виде списка:</p>
          <ul style="display: table; list-style-type:none">
            <li><b>1.</b> Задание 1</li>
            <li><b>...</b></li>
            <li><b>n.</b> Задание n</li>
          </ul>
          <p>Задания, требующие обязательного отображения в отчете, будут выделены <strong>полужирным шрифтом</strong></p>.
          </center>
        </div>
        </div>
        </div>
      </div>
      <!--/.Panel 1-->
      
      <!--Panel 2-->
      <div class="tab-pane fade" id="panel2" role="tabpanel">
        <div class="container-fluid">
        <div class="row">
        <div class="col-md-10 offset-md-1 col-lg-8 offset-lg-2">
          <br>
          <div class="card">
            <div class="card-header bg-info lighten-1 white-text text-center">
            	<h4>Тема 1. Генетический дрейф</h4>
              <h5>Часть 1.</h5>
            </div>
          	<div class="card-body text-justify">
          		<center>
          		<h4>
      				Определение
      				</h4>
      				</center>
      				<p>Генетический дрейф или дрейф аллелей – это изменение частот аллелей в популяции, вызванное случайным характером процессов воспроизведения. Под частотой аллели в популяции подразумевается доля копий гена с одинаковыми конкретными свойствами от количества всех копий этого гена.</p>
      				<p>Аллели потомства являются выборкой аллелей имеющихся в генотипах родителей. Другими словами, в популяции, каждая родительская особь формирует большое количество гамет. Учитывая, что размер потомства в реальных условиях ограничен, понятно, что не все гаметы образуют зиготы. Кроме того, не все зиготы в силу разных причин развиваются во взрослый организм. Таким образом, аллельная композиция потомства является выборкой из гамет, произведенных родительскими особями. Из этого следует, что частоты аллелей у потомства могут отличаться от соответствующих частот родителей. Изменения эти носят случайный характер и подчиняются статистическим законам.</p>
      				<p>Генетический дрейф может вызывать полную потерю аллелей в популяции, следовательно, ведет к уменьшению генетического разнообразия.</p>
      				<p>Эффект генетического дрейфа (различие между частотами родителей и потомства) зависит от размера. В случае, когда копий конкретной аллели мало, эффект проявляется сильнее. И наоборот.</p>
      				<p>Термин генетический дрейф введен в практику Сьюэлом Райтом в 1931 г.</p>
      				<center>
      				<h4>
      				Дрейф и фиксация
      				</h4>
      				</center>
      				<p>В изолированной популяции конечного размера новые аллели не могут формироваться в результате случайной выборки аллелей, передаваемых в следующее поколение. С другой стороны, случайная выборка может приводить к исключению аллеи из генофонда потомства. Таким образом, дрейф может исключить аллель из генофонда, но не может ее восстановить. Кроме того, случайное уменьшение или увеличение частоты аллели в результате дрейфа воздействует на частоты аллелей у последующих поколений. Следовательно, генетический дрейф смещает генетическую структуру популяции в сторону однородности. Если частота конкретной аллели, в результате дрейфа, достигает значения 1 (100%), говорят, что аллель «зафиксирована» в популяции. В противоположном случае, когда частота аллели становиться равной 0 (0%), аллель считается «утерянной». Как только аллель фиксируется или утрачивается в популяции, генетический дрейф по отношению к ней останавливается. В обоих критических случаях (фиксация, утеря) частота аллели может измениться только в случае привнесения новых аллелей извне (генетический ток) или вследствие мутаций.</p>
      				<center>
      				<h4>
      				Практическая часть
      				</h4>
      				</center>
      				<center>
      				<h5>
      				Описание алгоритма симуляции
      				</h5>
      				</center>
      				<p>В данной работе будет рассмотрен простой вариант симуляции генетического дрейфа в популяции диплоидных организмов в варианте стохастической реализации модели Райта-Фишера. В предлагаемом варианте рассматривается влияние дрейфа на частоту встречаемости одной аллели в популяции. Для удобства мы будем называть ее аллель “A-большое” – <strong>А</strong>. При этом, подразумевая, что тот же локус может занимать вторая аллель “а-малое” или <strong>а</strong>. Понятно, что сумма частот этих двух аллелей в популяции всегда равна 1. При этом возможны два крайних варианта: если частота <strong>А</strong>=1, то частота аллели <strong>а</strong> = 0. Такое состояние называется фиксацией аллели, т.е. все особи являются гомозиготными по аллели <strong>А</strong>. Такие же генотипы будут и у всех потомков в этой популяции. Обратная ситуация возникает, когда частота аллели <strong>А</strong> становиться равной 0. Из этого следует, что в популяции ни одна особь не содержит в генотипе аллель <strong>А</strong>, и ее появление у дальнейших поколений невозможно без мутации аллели <strong>а</strong> до состояния <strong>А</strong>, или заноса генетической информации извне. Такое состояние называют потерей аллели. Промежуточное состояние, когда частота <strong>А</strong> не равно 0 и 1, мы будем условно называть равновесием.</p>
      				<p>Алгоритм имитирует вероятностное перераспределение частот аллелей (или аллели, что равноценно) со сменой поколений особей. Подразумевается, что каждое <strong>n</strong> поколение содержит только потомков особей <strong>n-1</strong> поколения. В реальном мире такая система может быть представлена популяцией однолетних растений, с условием, что семена этих растений не сохраняются больше года а сами материнские растения не могут жить дольше одного года. В представленном алгоритме присутствует ряд идеализирующих приближений:</p>
      				<ol style='list-style-type: decimal'>
      					<li>все особи текущего поколения имеют одинаковую (идеальную) выживаемость.</li>
      					<li>вероятность обмена генетической информацией между особями равновероятна в пределах популяции.</li>
      					<li>размер популяции постоянен во времени.</li>
      					<li>в популяции отсутствует конкуренция между особями, также отсутствует и межвидовая конкуренция.</li>
      					<li>отсутствуют иные факторы, способные повлиять на наследование интересующего состояния аллели.</li>
      					<li>в популяции отсутствуют процессы мутации.</li>
      					<li>популяция полностью изолирована, т.е. отсутствуют эффекты генетического тока.</li>
      				</ol>
      				<p><em>Хотя, существование реальной популяции, отвечающей названным требованиям, маловероятно, предложенная модель остается наглядной. Результаты ее выполнения часто сопоставимы с эмпирическими данными. Нередко, модель Райта-Фишера используется в генетических исследованиях, как минимальный, интуитивно понятный источник нулевых гипотез.</em></p>
      				<p>В выбранной схеме теоретического опыта изменение частоты аллелей зависит от размера популяции, начальной частоты аллели, и количества учтенных поколений.</p>
      				<p>В предложенной модели расчет вероятностной частоты искомой аллели с течением времени зависит от 4 параметров: <strong>Количество поколений</strong> – количество поколений которое будет смоделировано, <strong>Начальная частота аллели А</strong> – частота аллели во всех моделируемых популяциях на момент начала симуляции, <strong>Размер популяции</strong> – количество особей в каждой из популяций, <strong>Количество популяций</strong> – количество популяций для которых будут сгенерированы частоты аллелей в последующих поколениях.</p>
      				<p>Вы можете изменять любые из 4 названных параметров с помощью слайдеров. После нажатия кнопки <strong>Смоделировать</strong> функция выдаст результат в виде графика. На графике, черной пунктирной линией отмечено исходная частота аллели. Цветные линии соответствуют показателю частоты этой же аллели у смоделированных популяций в течении времени. Каждая популяция обозначена одной линией. Отчетливо видно, что с каждым следующим поколением частота встречаемости аллели в каждой популяции изменяется. Так как генетический дрейф является случайным процессом, то кривые изменения частот для каждой популяции ожидаемо различаются.</p>
      				<p>Как было указано выше, возможны 3 варианта состояния аллели: <strong>фиксация</strong>, <strong>утрата</strong> и <strong>относительное равновесие</strong>. Если аллель зафиксировалась в какой-то из популяций, то на графике соответствующая линия достигнет верхней границы графика (частота = 1), и более не будет изменяться. При утере аллели, будет наблюдаться обратная картина – линия популяции достигнет нижнего края графика (частота = 0) и так же не будет изменяться. В случае относительного равновесия линия к концу периода симуляции не будет оставаться в пределах от &gt;0 и &lt;1.</p>
      				<p>Попробуйте поэкспериментировать с разными значениями параметров. Обратите внимание, что наиболее важным является размер популяции. При уменьшении числа особей вероятность фиксации или утраты аллели возрастает. Понятно, что вероятность фиксации или утраты, так же зависит от начальной частоты аллели. Если начальная частота высока, например 99%, то аллель, скорее всего, будет зафиксирована по прошествии времени. <br> <br></p>
          	</div>
          	<div class="card-body text-justify simulation">
          		<center><h4>Симуляция 1</h4></center>
          		<div class="row">
          			<div class="col-md-6 col-sm-12">
  						<div class="range-slider">
  							<p>
  							<label for="NGen">Количество поколений</label>
  							<input id="NGen" name="NGen" class="range-slider__range" type="range" min="50" max="300" value="150">
  							<span class="range-slider__value">0</span>
  							</p>
  						</div>
          			</div>
          			<div class="col-md-6 col-sm-12">
  						<div class="range-slider">
  							<label for="Freq">Исходная частота</label>
  							<input id="Freq" name="Freq" class="range-slider__range" type="range" min="0" max="1" value="0.5" step="0.05">
  							<span class="range-slider__value">0</span>
  						</div>
          			</div>
          		</div>
          		<div class="row">
          			<div class="col-md-6 col-sm-12">
  						<div class="range-slider">
  							<label for="PopSize">Размер популяции</label>
  							<input id="PopSize" name="PopSize" class="range-slider__range" type="range" min=1 max=500 value=100>
  							<span class="range-slider__value">0</span>
  						</div>
          			</div>
          			<div class="col-md-6 col-sm-12">
  						<div class="range-slider">
  							<label for="PopN">Количество популяций</label>
  							<input id="PopN" name="PopN" class="range-slider__range" type="range" min=1 max=10 value=5>
  							<span class="range-slider__value">0</span>
  						</div>
          			</div>
          		</div>
          		<div class="row text-center">
          			<div class="col">
                  <div class="button-wrap">
                  <button id="driftPlotButton" name="driftPlotButton" type="button" class="btn action-button btn-outline-danger waves-effect">Смоделировать</button>
                  </div>
          			</div>
          		</div>
          		<div class="row text-center">
          			<div class="col-lg-8 offset-lg-2 col-md-12">
                  <div class="plot-wrap text-center">
          				<div id="Drift_plot" class="shiny-plot-output drift-plot"></div>
                  </div>
          			</div>
          		</div>
          	</div>
            <div class="card-body text-justify tasks">
              <ol style='list-style-type: decimal'>
                <center>
                <h4>
                  Задания к симуляции 1.
                </h4>
                </center>
                <li>Повторите симуляцию несколько раз, варьируя <strong>начальную частоту аллели</strong>. Оцените, как изменяется вероятность фиксации или потери аллели в зависимости от ее начальной частоты (в каком случае больше вероятность утраты, а в каком вероятность фиксации).</li>
                <br>
                <li>Повторите симуляцию несколько раз задав следующие параметры: <strong>Количество поколений</strong>=150, <strong>Начальная частота аллели</strong>=0.5, <strong>Количество популяций</strong>=10. При этом, каждый раз изменяйте параметр <strong>Размер популяции</strong> (в пределах от 50 до 500). Сделайте вывод о том, как влияет размер популяции на вероятность фиксации аллели.</li>
                <br>
                <li><strong>Представьте, что в некоторой популяции у нескольких (возможно у одной) особей возникает негативная (понижающая жизнеспособность) мутация. Предположим, речь идет об очень большой популяции <em>Pinus silvestris</em> размеров в несколько миллионов особей. Не используя моделирование и опираясь на выводы сделанные в предыдущих задании, проведите мысленный анализ, насколько вероятно, что дрейф генов приведет к закреплению такой нежелательной мутации.</strong></li>
                <br>
                <li><strong>Опираясь на выводы предыдущих заданий, спрогнозируйте, как измениться вероятность закрепления негативной мутации (по аналогии с заданием 3), но для малой популяции, например эндемичной разновидности <em>Pinus sylvestris var. cretacea</em>.</strong></li>
                <br>
                <li><strong>
                  Опираясь на полученные знания о случайных процессах в генетической структуре популяций объясните, почему даже усиленная охрана исчезающих видов может не привести к их восстановлению.
                </strong></li>
                <br>
                <li><strong>
                  Предположите, к каким позитивным и негативным последствиям для популяции может принести действие генетического дрейфа.
                </strong>/li>
              </ol>
            </div>
            <div class="card-header bg-info lighten-1 white-text text-center">
              <h5>Часть 2.</h5>
            </div>
            <div class="card-body text-justify">
              В большинстве случаев, для исследовательских целей, моделирование состояния малого количества популяций не имеет особого значения, кроме понимания особенностей процесса дрейфа (направления, возможной динамики …). Куда более важным является возможность оценить вероятность фиксации или утраты аллели при известном начальном состоянии популяции. Оценку вероятностей обычно проводят с помощью аналитических формул. В некоторых случаях стохастические модели могут быть более гибким, хотя менее точным способом оценки вероятностей конечного состояния популяции.<br />Следующая модель основана на тех же принципах, что и предыдущая, за исключением того что симуляция проводиться одновременно для большого количества популяций (<strong>Количество популяций = 300</strong>). Обозначение параметров модели остается таким же, как в предыдущем случае. Изменяется способ визуализации. Итогом модели будет столбчатая диаграмма с тремя столбцами, отображающими количество популяций которые к концу симуляции находились в состояниях: условное равновесие, фиксация аллели, утрата аллели. Подписи по оси Х будут содержать числовое отображение количества соответствующих популяций. Для практических целей подобная модель должна проводиться для куда более большого количества популяций (&gt;10000). В обучающих целях, для оценки вероятности фиксации или утраты аллели нам будет достаточно и 300 популяций. Понятно, что вероятность конкретного состояния, будет равна доле популяций в таком состоянии от количества смоделированных популяций. Например, если в результате симуляции оказалось, что в 30 случаях аллель была утеряна, приблизительная вероятность утраты аллели в популяции с такими начальными условиями равна 0.1 (10%), т.е. 30/300. <br /> <br />
              <center>
              <h5>
              Симуляция может занять некоторое время. Нажмите кнопку смоделировать и дождитесь отображения результата
              </h5>
              </center>
            </div>
            <div class="card-body text-justify simulation">
              <center><h4>Симуляция 2</h4></center>
              <div class="row">
                <div class="col-md-6 col-sm-12">
                  <div class="range-slider">
                    <p>
                    <label for="NGen1">Количество поколений</label>
                    <input id="NGen1" name="NGen1" class="range-slider__range" type="range" min="50" max="300" value="150">
                    <span class="range-slider__value">0</span>
                    </p>
                  </div>
                </div>
                <div class="col-md-6 col-sm-12">
                  <div class="range-slider">
                    <p>
                    <label for="PopSize1">Размер популяции</label>
                    <input id="PopSize1" name="PopSize1" class="range-slider__range" type="range" min="1" max="500" value="100">
                    <span class="range-slider__value">0</span>
                    </p>
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="col">
                  <div class="range-slider">
                    <p>
                    <label for="Freq1">Начальная частота аллели А</label>
                    <input id="Freq1" name="Freq1" class="range-slider__range" type="range" min="0" max="1" value="0.5", step="0.01">
                    <span class="range-slider__value">0</span>
                    </p>
                  </div>
                </div>
              </div>
              <div class="row">
                <div class="col text-center">
                  <div class="button-wrap">
                  <button id="driftHistButton" name="driftHistButton" type="button" class="btn action-button btn-outline-danger waves-effect">Смоделировать</button>
                  </div>
                </div>
              </div>
              <div class="row text-center">
                <div class="col-lg-8 offset-lg-2 col-md-12">
                  <div class="plot-wrap text-center">
                  <div id="Drift_hist" class="shiny-plot-output drift-plot"></div>
                  </div>
                </div>
              </div>
            </div>
            <div class="card-body text-justify tasks">
              <center>
                <h4>
                  Задания к симуляции 2.
                </h4>
              </center>
              <ol style='list-style-type: decimal'>
                <li>
                  Установите показатели <strong>Количество поколений</strong>=150, <strong>Размер популяции</strong>=100. Проведите симуляцию несколько раз измен&#x0044F&#x0044F параметр <strong>Начальная частота аллели</strong>. Оцените, как зависит вероятность фиксации или утери аллели от ее начальной частоты.
                </li>
                <br>
                <li>
                  <strong>Установите начальные показатели <em>Количество поколений</em>=300, <em>Размер популяции</em>=50, смоделируйте ситуацию с очень низкой начальной частотой (приблизительно 0.03). Повторите симуляцию несколько раз. Оцените вероятность фиксации аллели при такой комбинации начальных параметров. Расчеты представьте в отчете (минимум три симуляции)</strong>
                </li>
                <br>
                <li>
                  <strong>Оцените, почему в предыдущем задании, не смотря на очень низкую начальную частоту, присутствует не нулевая вероятность фиксации аллели?</strong>
                </li>
                <br>
                <li>
                <strong>
                  Предположите, может ли действие генетического дрейфа привести к закреплению в популяции вредной мутации (исходно малочисленной аллели), несмотря на то, что естественный отбор будет стремиться исключить эту мутацию из популяции. Какие факторы будут влиять на итог такого процесса?
                </strong>
                </li>
              </ol>
            </div>
          </div>
        </div>
        </div>
      </div>  
      </div>
      <!--/.Panel 2-->
  </body>


  <script>
    $('#myTab a').click(function (e) {
        e.preventDefault();
        $(this).tab('show');
    });

    var rangeSlider = function(){
	  var slider = $('.range-slider'),
	      range = $('.range-slider__range'),
	      value = $('.range-slider__value');
	    
	  slider.each(function(){

	    value.each(function(){
	      var value = $(this).prev().attr('value');
	      $(this).html(value);
	    });

	    range.on('input', function(){
	      $(this).next(value).html(this.value);
	    });
	  });
	};

	rangeSlider();
  </script>
</html>